<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="icon" type="image/png" href="favicon.png">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Blackpill and Bluepill common code</title>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="jquery.min.js"></script>
    <script src="jquery.powertip.min.js"></script>
    <script src="jquery-ui.min.js"></script>
    <script src="doxy-jquery.js"></script>
    <script src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <!-- Bootstrap -->
    <link href="doxygen.css" rel="stylesheet">
    <link href="fonts.css" rel="stylesheet">
    <link href="bootstrap.min.css" rel="stylesheet">
    <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet">
    <link href="riot.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
      <div id="top">
        <nav class="navbar navbar-inverse">
          <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" id="brand-logo" href="http://riot-os.org"><img height="40px" src="riot-logo.svg" /></a>
              <p class="navbar-text text-center visible-xs">Documentation</p>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="navbar-collapse">
              <p class="navbar-text navbar-left"><span id="projectbrief">The friendly Operating System for the Internet of Things</span></p>
              <ul id="riot-navlist" class="nav navbar-nav"></ul>
              <!--BEGIN SEARCHENGINE hidden-sm hidden-xs"-->
              <form id="riot-searchform" class="navbar-form navbar-left navbar-right"
                    onsubmit="try{
                        var rhtml=document.getElementById('MSearchResults').contentWindow.document.body.innerHTML;
                        document.getElementById('MSearchResultsWindow').style.display='none';
                        document.getElementById('top').append(document.getElementById('MSearchSelectWindow'));
                        document.getElementById('top').append(document.getElementById('MSearchResultsWindow'));
                        document.getElementById('doc-content').innerHTML=rhtml;
                        }finally{
                            return false;
                    }">
                 <div class="form-group">
                   <div id="MSearchBox" class="MSearchBoxActive">
                     <div class="input-group">
                       <div class="input-group-addon">
                         <span id="MSearchSelect" class="glyphicon glyphicon-search" aria-hidden="true" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"></span>
                       </div>
                       <input class="form-control" type="text" id="MSearchField" placeholder="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event);
                              var r=document.getElementById('MSearchResultsWindow');
                              if(parseInt(r.style.left)<0)r.style.left=0;
                              var x=document.getElementById('MSearchResults');
                              if(x.scrollWidth>window.screen.width)x.style.width=window.screen.width-2+'px';
                              var f=document.getElementById('riot-searchform');
                              if(parseInt( r.style.top) < f.offsetTop+f.scrollHeight) r.style.top = f.offsetTop+f.scrollHeight+'px';">
                       <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()">
                         <span id="search-reset" class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>
                       </a>
                     </div>
                   </div>
                 </div>
              </form>
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container-fluid -->
        </nav>
      </div>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__boards__common__blxxxpill.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a>  </div>
  <div class="headertitle">
<div class="title">Blackpill and Bluepill common code<div class="ingroups"><a class="el" href="group__boards.html">Boards</a> &raquo; <a class="el" href="group__boards__common.html">Common Board Groups</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Support for cheap stm32f103c8 based boards such as bluepill and blackpill.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Support for cheap stm32f103c8 based boards such as bluepill and blackpill. </p>
<h2>Overview</h2>
<p>The bluepill and the blackpill are STM32F103 based board which can be bought for around 2€ on sides like AliExpress, eBay and others. Although the STM32F130C8 MCU nominally has 64 KiB flash, most <a href="https://web.archive.org/web/20190428082446/http://wiki.stm32duino.com/index.php?title=Blue_Pill#128_KB_flash_on_C8_version">actually have 128 KiB flash</a>.</p>
<p>There are also versions that only report to have 32 KiB, but actually have 64 KiB.</p>
<h2>Hardware</h2>
<div class="image">
<img src="https://camo.githubusercontent.com/6122268d77e4677a08d0e13e2e2aaf070a0a6a69/687474703a2f2f73312e62696c642e6d652f62696c6465722f3131303431372f38383135303232313438363837343334302e6a7067" alt="bluepill"/>
</div>
 <h3>MCU</h3>
<table class="doxtable">
<tr>
<th align="left">MCU </th><th align="left">STM32F103C8  </th></tr>
<tr>
<td align="left">Family </td><td align="left">ARM Cortex-M3 </td></tr>
<tr>
<td align="left">Vendor </td><td align="left">STMicroelectronics </td></tr>
<tr>
<td align="left">RAM </td><td align="left">20 KiB </td></tr>
<tr>
<td align="left">Flash </td><td align="left">32 KiB/ 64 KiB / 128 KiB </td></tr>
<tr>
<td align="left">Frequency </td><td align="left">up to 72 MHz </td></tr>
<tr>
<td align="left">Timer </td><td align="left">3x 16-Bit </td></tr>
<tr>
<td align="left">ADC </td><td align="left">2x 12-bit, 10 channels </td></tr>
<tr>
<td align="left">UART </td><td align="left">3 </td></tr>
<tr>
<td align="left">SPI </td><td align="left">2 </td></tr>
<tr>
<td align="left">I2C </td><td align="left">2 </td></tr>
<tr>
<td align="left">CAN </td><td align="left">1 </td></tr>
<tr>
<td align="left">Vcc </td><td align="left">2.0 to 3.6 V </td></tr>
<tr>
<td align="left">Datasheet </td><td align="left"><a href="http://www.st.com/content/ccc/resource/technical/document/datasheet/33/d4/6f/1d/df/0b/4c/6d/CD00161566.pdf/files/CD00161566.pdf/jcr:content/translations/en.CD00161566.pdf">Datasheet</a> </td></tr>
</table>
<h2>Implementation Status</h2>
<table class="doxtable">
<tr>
<th align="left">ID </th><th align="left">Supported  </th></tr>
<tr>
<td align="left">GPIO </td><td align="left">yes </td></tr>
<tr>
<td align="left">PWM </td><td align="left">yes </td></tr>
<tr>
<td align="left">UART </td><td align="left">yes </td></tr>
<tr>
<td align="left">ADC </td><td align="left">yes </td></tr>
<tr>
<td align="left">I2C </td><td align="left">yes </td></tr>
<tr>
<td align="left">SPI </td><td align="left">yes </td></tr>
<tr>
<td align="left">USB </td><td align="left">no </td></tr>
<tr>
<td align="left">Timer </td><td align="left">yes </td></tr>
<tr>
<td align="left">CAN </td><td align="left">no </td></tr>
</table>
<h2>Flashing</h2>
<p>To program and debug the board you need a SWD capable debugger. The easiest way is using <a href="https://github.com/RIOT-OS/RIOT/wiki/OpenOCD">OpenOCD</a>. By default RIOT uses the hardware reset signal and connects to the chip under reset for flashing. This is required to reliably connect to the device even when the MCU is in a low power mode. Therefore not only SWDIO and SWCLK, but also the RST pin of your debugger need to be connected to the board. Once the device is connected to the debugger and OpenOCD is installed, you can flash the device with: </p><pre class="fragment">$ make BOARD=bluepill flash
</pre><p>Or for the blackpill with: </p><pre class="fragment">$ make BOARD=blackpill flash
</pre><h3>Additional Flash</h3>
<p>To make use of the entire 128 KiB flash, compile and flash your application with: </p><pre class="fragment">$ make BOARD=bluepill-128kib flash
</pre><p>Or for the blackpill with: </p><pre class="fragment">$ make BOARD=blackpill-128kib flash
</pre><p>This sets the <code>CPU_MODEL</code> make variable to <code>stm32f103cb</code>, the default value is <code>stm32f103c8</code>. These two CPU models basically only have one major difference, the former has 128 KiB flash while the latter has 64 KiB.</p>
<p>Flashing for the 128KiB version currently (as of September 2019) requires the development version of OpenOCD.</p>
<h2>Connecting via Serial</h2>
<p>The default UART port used is UART2, which uses pins A2 (TX) and A3 (RX). To use it, configure your UART to operate at a baudrate of 115200/8N1.</p>
<h2>Using PWM</h2>
<p>PWM is available at pins A8 to A11.</p>
<h2>Known Issues</h2>
<h3>USB connector</h3>
<p>The Micro-USB port is sometimes not soldered properly. Also, it is usually equipped with an incorrect resistor. <a href="https://web.archive.org/web/20190428082446/http://wiki.stm32duino.com/index.php?title=Blue_Pill#Hardware_installation">This can be fixed multiple ways</a>.</p>
<h3>Flashing fails</h3>
<p>Please check whether the debugger is properly connected, including the hardware reset signal pin.</p>
<table class="doxtable">
<tr>
<th align="left">Pin on Debugger </th><th align="left">Pin on Blue Pill  </th></tr>
<tr>
<td align="left">SWDIO </td><td align="left">DIO </td></tr>
<tr>
<td align="left">SWCLK </td><td align="left">DCLK </td></tr>
<tr>
<td align="left">NRST </td><td align="left">R </td></tr>
<tr>
<td align="left">GND </td><td align="left">GND </td></tr>
<tr>
<td align="left">VDD (3.3V) (*) </td><td align="left">3.3 </td></tr>
<tr>
<td align="left">Target VCC (**) </td><td align="left">3.3 </td></tr>
</table>
<ul>
<li>(*) Most debuggers have a 3.3V supply voltage to power the board. You can alternatively power the board using the TTL-Adapter or via Micro-USB.</li>
<li>(**) Some debuggers monitor the voltage of the target MCU. Their target VCC pin needs to be connected to one of the 3.3V pins of the boards.</li>
</ul>
<p>Most very cheap SWD debuggers (especially those imported for about 2€ from far east) do not have a Target VCC pin; they will still work just fine. On these cheap debuggers the pin to send the reset signal to the board is often either not present or defunct. You can work around this by pressing the reset button when OpenOCD wants to connect to the Blue Pill. Hit the reset button again after flashing in order to boot the newly flashed image.</p>
<h2>Where to buy</h2>
<p>The board is sold under different names. On some sites it is called <code>bluepill</code> or <code>blue pill</code>. On others you might find it by searching for <code>stm32f103c8</code> or <code>stm32f103c8t6</code>.</p>
<p>Try <a href="https://www.ebay.com/sch/i.html?_nkw=stm32f103c8">eBay</a> or <a href="https://www.aliexpress.com/wholesale?SearchText=STM32F103C8T6">AliExpress</a>.</p>
<h2>Further reading</h2>
<ul>
<li><a href="https://web.archive.org/web/20190428082446/http://wiki.stm32duino.com/index.php?title=Blue_Pill">Blue Pill Wiki</a></li>
<li><a href="https://web.archive.org/web/20190428082446/http://wiki.stm32duino.com/index.php?title=Maple_Mini#Clones">Maple Mini Wiki</a></li>
<li><a href="http://www.st.com/content/st_com/en/products/microcontrollers/stm32-32-bit-arm-cortex-mcus/stm32-mainstream-mcus/stm32f1-series/stm32f103/stm32f103c8.html">STM32F103C8 Datasheet</a></li>
</ul>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:blxxxpill_2include_2board__common_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="blxxxpill_2include_2board__common_8h.html">board_common.h</a></td></tr>
<tr class="memdesc:blxxxpill_2include_2board__common_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Peripheral MCU configuration for the bluepill/blackpill board. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:common_2blxxxpill_2include_2gpio__params_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="common_2blxxxpill_2include_2gpio__params_8h.html">gpio_params.h</a></td></tr>
<tr class="memdesc:common_2blxxxpill_2include_2gpio__params_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Board specific configuration of direct mapped GPIOs. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:boards_2common_2blxxxpill_2include_2periph__conf_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="boards_2common_2blxxxpill_2include_2periph__conf_8h.html">periph_conf.h</a></td></tr>
<tr class="memdesc:boards_2common_2blxxxpill_2include_2periph__conf_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Peripheral MCU configuration for the bluepill/blackpill boards. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
    <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
        <ul>
            <li class="footer">Generated on Thu Jul 2 2020 15:49:28 by <a href="http://www.doxygen.org/index.html">
                       <img class="footer" src="doxygen.png" alt="doxygen"></a> 1.8.13</li>
        </ul>
    </div>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="bootstrap.min.js"></script>
    <script src="jquery.smartmenus.min.js"></script>
    <script src="jquery.smartmenus.bootstrap.min.js"></script>
    <script src="riot-doxy.js"></script>
  </body>
</html>
